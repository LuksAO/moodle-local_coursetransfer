/**
 * @package
 * @author  2022 3iPunt <https://www.tresipunt.com/>
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_coursetransfer/origin_restore_course_step3",["jquery","core/str","core/ajax","core/templates"],(function($,Str,Ajax,Templates){let ACTIONS_NEXT='[data-action="next"]',ACTIONS_CHECK='[data-action="check"]',ACTIONS_CHECK_ACT='[data-action="act-check"]';function restoreCourseStep3(region){this.node=$(region),this.data={course:{id:parseInt($("[data-course-id]").attr("data-course-id")),fullname:$("[data-course-fullname]").attr("data-course-fullname"),shortname:$("[data-course-shortname]").attr("data-course-shortname"),idnumber:$("[data-course-idnumber]").attr("data-course-idnumber"),categoryid:parseInt($("[data-course-categoryid]").attr("data-course-categoryid")),categoryname:$("[data-course-categoryname]").attr("data-course-categoryname"),backupsizeestimated:parseInt($("[data-course-backupsizeestimated]").attr("data-course-backupsizeestimated")),sections:[]}},this.node.find(ACTIONS_NEXT).on("click",this.clickNext.bind(this)),this.node.find(ACTIONS_CHECK).on("click",this.clickCheck.bind(this)),this.node.find(ACTIONS_CHECK_ACT).on("click",this.clickActCheck.bind(this))}return restoreCourseStep3.prototype.clickActCheck=e=>{e.currentTarget.checked&&(e.currentTarget.parentElement.parentElement.parentElement.parentElement.parentElement.children[0].children[0].children[0].checked=!0)},restoreCourseStep3.prototype.clickCheck=e=>{if([...e.currentTarget.parentElement.parentElement.parentElement.children].length>1){let activities=[...e.currentTarget.parentElement.parentElement.parentElement.children[1].children[0].children];activities.shift(),activities.forEach((v=>{v.children[0].children[0].checked=e.currentTarget.checked}))}},restoreCourseStep3.prototype.clickNext=function(e){let rawSections=[...$(".sections-table").children()];rawSections.shift(),this.data.course.sections=rawSections.map((v=>{let finalActivities=[];if(v.children.length>=2){let activities=[...[...v.children][1].children[0].children];activities.shift(),finalActivities=activities.map((v=>({selected:v.children[0].children[0].checked,cmid:v.getAttribute("data-activity-cmid"),name:v.getAttribute("data-activity-name"),instance:v.getAttribute("data-activity-instance"),modname:v.getAttribute("data-activity-modname")})))}return{selected:v.children[0].children[0].children[0].checked,sectionnum:v.getAttribute("data-section-sectionnum"),sectionid:v.getAttribute("data-section-sectionid"),sectionname:v.getAttribute("data-section-sectionname"),activities:finalActivities}})),console.log(this.data);sessionStorage.setItem($("[data-course-sessionStorageId]").attr("data-course-sessionStorageId"),JSON.stringify(this.data))},restoreCourseStep3.prototype.node=null,{initRestoreCourseStep3:function(region){return new restoreCourseStep3(region)}}}));

//# sourceMappingURL=origin_restore_course_step3.min.js.map