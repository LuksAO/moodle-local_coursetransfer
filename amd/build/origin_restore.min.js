/**
 *
 * @module     local_coursetransfer
 * @copyright  2023 Proyecto UNIMOODLE
 * @author     UNIMOODLE Group (Coordinator) <direccion.area.estrategia.digital@uva.es>
 * @author     3IPUNT <contacte@tresipunt.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_coursetransfer/origin_restore",["jquery","core/str","core/ajax","core/templates","local_coursetransfer/JSONutil"],(function($,Str,Ajax,Templates,JSONutil){let SERVICES_ORIGIN_RESTORE_STEP1="local_coursetransfer_origin_restore_step1",ACTIONS_NEXT='[data-action="next"]';function originRestore(region){this.node=$(region),this.node.find(ACTIONS_NEXT).on("click",this.clickNext.bind(this)),sessionStorage.setItem("local_coursetransfer_restore_page",JSON.stringify(null,JSONutil.replacer))}return originRestore.prototype.clickNext=function(e){let self=this,alertbox=this.node.find(".alert"),siteurl=this.node.find("#id_origin_site option:selected").val(),type=this.node.find("#id_course_categories option:selected").val();const request={methodname:SERVICES_ORIGIN_RESTORE_STEP1,args:{siteurl:siteurl,type:type}};Ajax.call([request])[0].done((function(response){if(response.success)window.location.href=response.data.nexturl;else if(response.success){let errors=[{code:"100041",msg:"error_not_controlled"}];self.renderErrors(errors,alertbox)}else self.renderErrors(response.errors,alertbox)})).fail((function(fail){let errors=[{code:"100042",msg:fail.message}];self.renderErrors(errors,alertbox)}))},originRestore.prototype.renderErrors=function(errors,alertbox){let errorString="";alertbox.removeClass("hidden"),errors.forEach((error=>{errorString+="Error ("+error.code+"): "+error.msg+"<br>"})),alertbox.append(errorString)},originRestore.prototype.node=null,{initOriginRestore:function(region){return new originRestore(region)}}}));

//# sourceMappingURL=origin_restore.min.js.map